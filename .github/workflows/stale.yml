name: "Stale Issue & PR Management"

on:
  schedule:
    # Run daily at 1 AM UTC
    - cron: '0 1 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - name: Stale Issue & PR Handler
        uses: actions/stale@v9
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}
          
          # Days before marking as stale
          days-before-stale: 60
          days-before-close: 14
          
          # Issue settings
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had recent activity.
            It will be closed in 14 days if no further activity occurs.
            
            If this issue is still relevant, please:
            - Comment on this issue to keep it open
            - Provide updates on the status
            - Add more context if needed
            
            Thank you for your contribution to TiltCheck! ðŸŽ²
          close-issue-message: |
            This issue has been automatically closed due to inactivity.
            
            If you believe this issue should be reopened, please:
            - Comment on this issue explaining why it should be reopened
            - Open a new issue with updated context if the situation has changed
            
            Thank you for your contribution to TiltCheck! ðŸŽ²
          stale-issue-label: 'stale'
          
          # PR settings
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not had recent activity.
            It will be closed in 14 days if no further activity occurs.
            
            If this PR is still relevant, please:
            - Rebase on the latest main branch
            - Resolve any merge conflicts
            - Address review comments
            - Comment to keep this PR open
            
            Thank you for your contribution to TiltCheck! ðŸŽ²
          close-pr-message: |
            This pull request has been automatically closed due to inactivity.
            
            If you want to continue with this PR:
            - Reopen the PR
            - Rebase on the latest main branch
            - Address any outstanding review comments
            
            Thank you for your contribution to TiltCheck! ðŸŽ²
          stale-pr-label: 'stale'
          
          # Exemptions
          exempt-issue-labels: 'security,pinned,roadmap,help-wanted,good-first-issue'
          exempt-pr-labels: 'security,pinned,work-in-progress'
          exempt-milestones: true
          exempt-assignees: true
          
          # Operations per run (to avoid rate limiting)
          operations-per-run: 30
          
          # Remove stale label when updated
          remove-stale-when-updated: true
          
          # Additional options
          ascending: false
          delete-branch: false
