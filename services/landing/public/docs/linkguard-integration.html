<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><title>LinkGuard (SusLink) Integration Design - TiltCheck</title><meta name="description" content="Purpose: Migrate LinkGuard (&quot;SusLink&quot;) link verification outcomes into the unified `trust.casino.updated` (and future `trust.domain.updated`) event fabric so downstream adapters (D"/><link rel="stylesheet" href="/styles/base.css"/><style>body{background:#0a0a0a;color:#e0e0e0;font-family:Inter,system-ui,sans-serif;margin:0;padding:0}main{max-width:900px;margin:0 auto;padding:40px 18px;line-height:1.7}a{color:#00d4aa;text-decoration:none}a:hover{text-decoration:underline}.page-hero{padding:54px 24px 32px;background:linear-gradient(135deg,#121212,#181818);border-bottom:1px solid #222}.page-hero h1{margin:0 0 10px;font-size:2.4rem;background:linear-gradient(135deg,#00d4aa,#00a8ff);-webkit-background-clip:text;color:transparent}.lede{color:#aaa;font-size:1.05rem;max-width:760px}pre{background:#181818;padding:14px 16px;border:1px solid #222;border-radius:8px;overflow:auto;font-size:.85rem}code{font-family:ui-monospace,Monaco,Consolas,monospace;color:#00a8ff}.breadcrumb{font-size:.7rem;letter-spacing:.12em;text-transform:uppercase;color:#888;margin:0 0 12px}.nav-inline{display:flex;gap:20px;align-items:center;font-size:.8rem;padding:10px 20px;background:#111;border-bottom:1px solid #222}nav a{color:#aaa}nav a[aria-current="page"]{color:#00d4aa;font-weight:600}</style></head><body><nav class="nav-inline"><a href="/" >Home</a><a href="/docs/index.html" aria-current="page">Docs</a><a href="/dashboard">Dashboard</a><a href="/about.html">About</a></nav><header class="page-hero"><div class="breadcrumb">Docs / LinkGuard (SusLink) Integration Design</div><h1>LinkGuard (SusLink) Integration Design</h1><p class="lede">Purpose: Migrate LinkGuard (&quot;SusLink&quot;) link verification outcomes into the unified `trust.casino.updated` (and future `trust.domain.updated`) event fabric so downstream adapters (D</p></header><main id="content"><h1>LinkGuard (SusLink) Integration Design</h1>

<p>Purpose: Migrate LinkGuard ("SusLink") link verification outcomes into the unified <code>trust.casino.updated</code> (and future <code>trust.domain.updated</code>) event fabric so downstream adapters (Discord bots, monitoring, volatility engines) can react uniformly with severity scoring.</p>

<h2>Event Strategy</h2>

<p>While casino trust focuses on gambling domains, LinkGuard broadens to all Discordâ€‘shared links. We introduce a sibling event: <code>trust.domain.updated</code> for nonâ€‘casino domains; casino domains still emit <code>trust.casino.updated</code> for consistency.</p>

<p>| Source            | Event Name             | Entity Field    | Use Case                               |</p>
<p>|-------------------|------------------------|-----------------|----------------------------------------|</p>
<p>| LinkGuard scan    | trust.domain.updated   | <code>domain</code>        | General domain reputation & risk feed  |</p>
<p>| LinkGuard scan    | trust.casino.updated   | <code>casinoName</code>    | Casino ecosystem trust adjustments     |</p>
<p>| Manual admin add  | trust.domain.updated   | <code>domain</code>        | Override (safe/unsafe) propagation     |</p>
<p>| User report flow  | trust.domain.updated   | <code>domain</code>        | Increments risk on validated report    |</p>

<h2>Severity Mapping</h2>

<p>Leverage <code>@tiltcheck/config</code> <code>computeSeverity(score, scale)</code> using a normalized risk score (0â€“100). LinkGuard will internally classify links into categories mapped to base scores:</p>

<p>| Category        | Base Score | Delta Sign | Notes |</p>
<p>|-----------------|------------|------------|-------|</p>
<p>| safe            | 5          | +          | Minor reinforcement (cap growth) |</p>
<p>| unknown         | 25         | Â±          | Neutral; emits only if prior state differs |</p>
<p>| suspicious      | 55         | -          | Medium risk; triggers adapter highlight |</p>
<p>| unsafe          | 75         | -          | High risk; escalate severity badge |</p>
<p>| malicious       | 90         | -          | Critical; immediate alert channel |</p>

<p>Delta calculation pseudo:</p>
<pre class="code-block" data-lang=""><code>
newScore = clamp(previousScore + signedBaseDelta, 0, 100)
delta = newScore - previousScore
severity = computeSeverity(Math.abs(delta), DEFAULT_SEVERITY_SCALE)
</code></pre>
<p>For admin overrides, set <code>reason = &#39;override:{safe|unsafe}&#39;</code> and include <code>metadata:{actor, previousScore}</code>.</p>

<h2>Emission Function (Example)</h2>
<pre class="code-block" data-lang="ts"><code>
import { computeSeverity, DEFAULT_SEVERITY_SCALE } from &#39;@tiltcheck/config&#39;;
import { EventRouter, TrustDomainUpdateEvent } from &#39;@tiltcheck/types&#39;;

// Proposed new type extension
// interface TrustDomainUpdateEvent {
//   type: &#39;trust.domain.updated&#39;;
//   domain: string;
//   delta: number;
//   score: number; // post-update 0-100
//   severity: number; // mapped bucket
//   category: string; // safe|unknown|suspicious|unsafe|malicious
//   reason: string; // human readable summary
//   source: &#39;linkguard&#39;;
//   metadata?: Record&lt;string, any&gt;;
//   ts: number;
// }

export function emitDomainTrust({ router, domain, previousScore, category, actor, context }) {
  const baseScores = { safe: 5, unknown: 0, suspicious: -20, unsafe: -35, malicious: -50 };
  const rawDelta = baseScores[category] ?? 0; // signed delta
  const newScore = Math.max(0, Math.min(100, previousScore + rawDelta));
  const delta = newScore - previousScore;
  if (delta === 0) return; // no-op
  const severity = computeSeverity(Math.abs(delta), DEFAULT_SEVERITY_SCALE);
  const evt = {
    type: &#39;trust.domain.updated&#39;,
    domain,
    delta,
    score: newScore,
    severity,
    category,
    reason: `risk:${category}`,
    source: &#39;linkguard&#39;,
    metadata: { actor, context },
    ts: Date.now()
  } satisfies TrustDomainUpdateEvent;
  router.publish(evt.type, evt);
}
</code></pre>

<h2>State & Persistence</h2>

<p>Maintain a lightweight in-memory cache (domain â†’ score) with optional periodic snapshot (JSON file or SQLite) to ensure continuity after restarts. For casino domains, map <code>domain</code> â†’ canonical <code>casinoName</code> via a normalization table and emit both events if relevant.</p>

<h2>Downstream Adapter Expectations</h2>

<p>Consumers (FreeSpinsChannelBot, monitoring dashboards) will:</p>
<p>1. Subscribe to both <code>trust.domain.updated</code> & <code>trust.casino.updated</code>.</p>
<p>2. Display severity badges (ðŸŸ¢ low / ðŸŸ¡ medium / ðŸŸ  high / ðŸ”´ critical).</p>
<p>3. Provide delta formatting: <code>(+5)</code> or <code>(-20)</code> with colorization.</p>
<p>4. Aggregate hourly rollups (planned <code>trust.domain.rollup</code>).</p>

<h2>Rollup Design (Preview)</h2>
<p>Collect events over a sliding hour window:</p>
<pre class="code-block" data-lang=""><code>
rollup = {
  hourStartTs,
  domains: {
    example.com: { totalDelta: -55, events: 3, lastSeverity: 3 },
    casinoX: { totalDelta: +10, events: 2, lastSeverity: 1 }
  }
}
</code></pre>
<p>Emit <code>trust.domain.rollup</code> hourly for monitoring and potential alerting when <code>totalDelta &lt;= -40</code> within one window.</p>

<h2>Open Questions</h2>
<p>1. Confirm canonical list of casino domains for dual emission.</p>
<p>2. Decide persistence layer (file vs SQLite) matching scrappy/cheap infra rule.</p>
<p>3. Finalize severity scale thresholds for domain trust separate from casino trust (may reuse existing scale initially).</p>
<p>4. Whether user reports immediately reduce score or require moderation queue.</p>

<h2>Implementation Steps (Suggested)</h2>
<p>1. Add new type <code>TrustDomainUpdateEvent</code> to <code>@tiltcheck/types</code>.</p>
<p>2. Implement domain score cache + normalization.</p>
<p>3. Integrate emission in LinkGuard command handlers (<code>!verifylink</code>, <code>!reportlink</code>, admin overrides).</p>
<p>4. Create rollup scheduler (hourly) publishing summary events.</p>
<p>5. Update FreeSpinsChannelBot adapter to format trust changes.</p>
<p>6. Add monitoring script (optional alerts when malicious events occur).</p>

<h2>Safety & Anti-Tilt Considerations</h2>
<p>Avoid penalizing domains repeatedly in rapid succession (cooldown: minimum 60s between identical category hits). Prevent negative score cascades by flooring at 0 and limiting single-event delta magnitude (e.g. max -50). Ensure manual overrides log actor identity to metadata for audit.</p>

<p>---</p>
<p>This document provides the blueprint; awaiting LinkGuard source code integration points to proceed with concrete patches.</p>
</main><footer style="padding:40px 24px;text-align:center;font-size:.75rem;color:#666;border-top:1px solid #222">TiltCheck Docs â€¢ Non-custodial â€¢ Signals only.</footer></body></html>